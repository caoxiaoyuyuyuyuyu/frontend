{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<script>\nexport default {\n  onLaunch: function() {\n    console.log('App Launch')\n    this.setupInterceptor()\n    this.checkLogin()\n  },\n  methods: {\n    checkLogin() {\n      const token = uni.getStorageSync('token')\n      if (!token) {\n        uni.reLaunch({ url: '/pages/login/login' })\n        return false\n      }\n\n      // 可选：验证token有效性\n      uni.request({\n        url: 'http://localhost:5000/api/auth/check_login',\n        method: 'GET',\n        header: { 'Authorization': `Bearer ${token}` },\n        success: (res) => {\n          if (res.data.code === 401) {\n            this.handleLogout()\n          }\n        },\n        fail: () => {\n          console.log('验证登录状态失败')\n        }\n      })\n      \n      return true\n    },\n    \n    handleLogout() {\n      uni.removeStorageSync('token')\n      uni.removeStorageSync('userInfo')\n      uni.reLaunch({ url: '/pages/login/login' })\n    },\n    \n    setupInterceptor() {\n      // 请求拦截器 - 添加token\n      uni.addInterceptor('request', {\n        invoke(args) {\n          const token = uni.getStorageSync('token')\n          if (token) {\n            if (!args.header) args.header = {}\n            args.header['Authorization'] = `Bearer ${token}`\n          }\n          return args\n        },\n        fail(err) {\n          console.error('请求失败:', err)\n        }\n      })\n      \n      // 响应拦截器 - 处理401错误\n      uni.addInterceptor('request', {\n        success(args) {\n          if (args.data && args.data.code === 401) {\n            this.handleLogout()\n          }\n          return args\n        }\n      })\n    }\n  }\n}\n</script>\r\n<style>\r\n\t/*每个页面公共css */\r\n</style>\n","import App from './App'\n\n// #ifndef VUE3\nimport Vue from 'vue'\nimport './uni.promisify.adaptor'\nVue.config.productionTip = false\nApp.mpType = 'app'\nconst app = new Vue({\n  ...App\n})\napp.$mount()\n// #endif\n\n// #ifdef VUE3\nimport { createSSRApp } from 'vue'\nexport function createApp() {\n  const app = createSSRApp(App)\n  return {\n    app\n  }\n}\n// #endif"],"names":["uni","createSSRApp","App"],"mappings":";;;;;;;;;;;;;;;AACA,MAAK,YAAU;AAAA,EACb,UAAU,WAAW;AACnBA,kBAAAA,MAAY,MAAA,OAAA,gBAAA,YAAY;AACxB,SAAK,iBAAiB;AACtB,SAAK,WAAW;AAAA,EACjB;AAAA,EACD,SAAS;AAAA,IACP,aAAa;AACX,YAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,UAAI,CAAC,OAAO;AACVA,sBAAAA,MAAI,SAAS,EAAE,KAAK,sBAAsB;AAC1C,eAAO;AAAA,MACT;AAGAA,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,QAAQ,EAAE,iBAAiB,UAAU,KAAK,GAAI;AAAA,QAC9C,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,KAAK,SAAS,KAAK;AACzB,iBAAK,aAAa;AAAA,UACpB;AAAA,QACD;AAAA,QACD,MAAM,MAAM;AACVA,wBAAAA,MAAA,MAAA,OAAA,iBAAY,UAAU;AAAA,QACxB;AAAA,OACD;AAED,aAAO;AAAA,IACR;AAAA,IAED,eAAe;AACbA,oBAAG,MAAC,kBAAkB,OAAO;AAC7BA,oBAAG,MAAC,kBAAkB,UAAU;AAChCA,oBAAAA,MAAI,SAAS,EAAE,KAAK,sBAAsB;AAAA,IAC3C;AAAA,IAED,mBAAmB;AAEjBA,oBAAG,MAAC,eAAe,WAAW;AAAA,QAC5B,OAAO,MAAM;AACX,gBAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,cAAI,OAAO;AACT,gBAAI,CAAC,KAAK;AAAQ,mBAAK,SAAS,CAAC;AACjC,iBAAK,OAAO,eAAe,IAAI,UAAU,KAAK;AAAA,UAChD;AACA,iBAAO;AAAA,QACR;AAAA,QACD,KAAK,KAAK;AACRA,wBAAAA,MAAc,MAAA,SAAA,iBAAA,SAAS,GAAG;AAAA,QAC5B;AAAA,OACD;AAGDA,oBAAG,MAAC,eAAe,WAAW;AAAA,QAC5B,QAAQ,MAAM;AACZ,cAAI,KAAK,QAAQ,KAAK,KAAK,SAAS,KAAK;AACvC,iBAAK,aAAa;AAAA,UACpB;AACA,iBAAO;AAAA,QACT;AAAA,OACD;AAAA,IACH;AAAA,EACF;AACF;ACnDO,SAAS,YAAY;AAC1B,QAAM,MAAMC,cAAY,aAACC,SAAG;AAC5B,SAAO;AAAA,IACL;AAAA,EACD;AACH;;;"}