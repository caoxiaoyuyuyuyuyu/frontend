{"version":3,"file":"chatAI.js","sources":["pages/chatAI/chatAI.vue","../../HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2hhdEFJL2NoYXRBSS52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"chat-container\">\r\n\t\t<!-- 搜索栏 -->\r\n\t\t<view class=\"search-container\">\r\n\t\t\t<view class=\"history-btn\" @tap=\"showHistorySidebar\">\r\n\t\t\t\t<image src=\"/static/history.png\" class=\"history-icon\"></image>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"search-box\">\r\n\t\t\t\t<image src=\"/static/search.png\" class=\"search-icon\"></image>\r\n\t\t\t\t<input \r\n\t\t\t\t\tclass=\"search-input\" \r\n\t\t\t\t\tv-model=\"searchKeyword\" \r\n\t\t\t\t\tplaceholder=\"搜索对话内容...\"\r\n\t\t\t\t\t@input=\"onSearchInput\"\r\n\t\t\t\t\t@confirm=\"performSearch\"\r\n\t\t\t\t/>\r\n\t\t\t\t<view v-if=\"searchKeyword\" class=\"clear-btn\" @tap=\"clearSearch\">\r\n\t\t\t\t\t<text class=\"clear-icon\">×</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<button \r\n\t\t\t\tclass=\"new-chat-btn\" \r\n\t\t\t\t@tap=\"createNewChat\"\r\n\t\t\t\t:disabled=\"isLoading\"\r\n\t\t\t>\r\n\t\t\t\t<image src=\"/static/add.png\" class=\"new-chat-icon\"></image>\r\n\t\t\t</button>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 聊天消息列表 -->\r\n\t\t<scroll-view \r\n\t\t\tclass=\"chat-list\" \r\n\t\t\tscroll-y=\"true\" \r\n\t\t\t:scroll-top=\"scrollTop\"\r\n\t\t\t:scroll-into-view=\"scrollIntoView\"\r\n\t\t\t:show-scrollbar=\"false\"\r\n\t\t>\r\n\t\t\t<!-- 欢迎界面 -->\r\n\t\t\t<view v-if=\"messageList.length === 0\" class=\"welcome-container\">\r\n\t\t\t\t<view class=\"welcome-content\">\r\n\t\t\t\t\t<text class=\"welcome-title\">欢迎使用智慧害虫AI问答助手</text>\r\n\t\t\t\t\t<text class=\"welcome-subtitle\">我可以帮您识别各种害虫并提供专业建议，请详细描述您遇到的问题</text>\t\t\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view \r\n\t\t\t\tv-for=\"(message, index) in messageList\" \r\n\t\t\t\t:key=\"index\"\r\n\t\t\t\t:class=\"['message-item', message.type === 'user' ? 'user-message' : 'ai-message', isMessageHighlighted(message) ? 'highlighted-message' : '']\"\r\n\t\t\t\t:id=\"'msg-' + index\"\r\n\t\t\t>\r\n\t\t\t\t<view class=\"message-content\">\r\n\t\t\t\t\t<view class=\"avatar\">\r\n\t\t\t\t\t\t<image \r\n\t\t\t\t\t\t\t:src=\"message.type === 'user' ? userAvatar : aiAvatar\" \r\n\t\t\t\t\t\t\tclass=\"avatar-img\"\r\n\t\t\t\t\t\t></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"message-bubble\">\r\n\t\t\t\t\t\t<!-- 引用内容显示 -->\r\n\t\t\t\t\t\t<text v-if=\"message.hasQuote\" class=\"quote-content\">{{ getQuoteContent(message.content) }}</text>\r\n\t\t\t\t\t\t<!-- 分隔线 -->\r\n\t\t\t\t\t\t<view v-if=\"message.hasQuote\" class=\"quote-divider\"></view>\r\n\t\t\t\t\t\t<text v-if=\"!message.image\" class=\"message-text\">{{ getMainContent(message.content) }}</text>\r\n\t\t\t\t\t\t<image v-if=\"message.image\" :src=\"message.image\" class=\"message-image\" mode=\"aspectFit\"></image>\r\n\t\t\t\t\t\t<text class=\"message-time\">{{ message.time }}</text>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<!-- AI消息的操作按钮 -->\r\n\t\t\t\t\t\t<view v-if=\"message.type === 'ai'\" class=\"message-actions\">\r\n\t\t\t\t\t\t\t<view class=\"action-btn\" @tap=\"copyMessage(message.content)\">\r\n\t\t\t\t\t\t\t\t<image src=\"/static/copy.png\" class=\"action-icon\"></image>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"action-btn\" @tap=\"quoteMessage(message)\">\r\n\t\t\t\t\t\t\t\t<image src=\"/static/quote.png\" class=\"action-icon\"></image>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"action-btn\" @tap=\"toggleStar(message, index)\">\r\n\t\t\t\t\t\t\t\t<image :src=\"message.starred ? '/static/stars.png' : '/static/star.png'\" class=\"action-icon\"></image>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"action-btn\" @tap=\"feedbackMessage(message)\">\r\n\t\t\t\t\t\t\t\t<image src=\"/static/notification.png\" class=\"action-icon\"></image>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 加载状态 -->\r\n\t\t\t<view v-if=\"isLoading\" class=\"loading-message\">\r\n\t\t\t\t<view class=\"message-content\">\r\n\t\t\t\t\t<view class=\"avatar\">\r\n\t\t\t\t\t\t<image :src=\"aiAvatar\" class=\"avatar-img\"></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"message-bubble\">\r\n\t\t\t\t\t\t<view class=\"typing-indicator\">\r\n\t\t\t\t\t\t\t<view class=\"dot\"></view>\r\n\t\t\t\t\t\t\t<view class=\"dot\"></view>\r\n\t\t\t\t\t\t\t<view class=\"dot\"></view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t\t\r\n\t\t<!-- 引用提示框 -->\r\n\t\t<view v-if=\"quotedMessage\" class=\"quote-container\">\r\n\t\t\t<view class=\"quote-content\">\r\n\t\t\t\t<text class=\"quote-label\">引用：</text>\r\n\t\t\t\t<text class=\"quote-text\">{{ quotedMessage.content }}</text>\r\n\t\t\t\t<view class=\"quote-close\" @tap=\"clearQuote\">\r\n\t\t\t\t\t<text class=\"close-icon\">×</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 底部输入区域 -->\r\n\t\t<view class=\"input-area\">\r\n\t\t\t<view class=\"input-container\">\r\n\t\t\t\t<input \r\n\t\t\t\t\tclass=\"message-input\" \r\n\t\t\t\t\tv-model=\"inputMessage\" \r\n\t\t\t\t\tplaceholder=\"请输入您的问题...\"\r\n\t\t\t\t\t:disabled=\"isLoading\"\r\n\t\t\t\t\t@confirm=\"sendMessage\"\r\n\t\t\t\t/>\r\n\t\t\t\t<button \r\n\t\t\t\t\tclass=\"send-btn\" \r\n\t\t\t\t\t:disabled=\"!inputMessage.trim() || isLoading\"\r\n\t\t\t\t\t@tap=\"sendMessage\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<image src=\"/static/up.png\" class=\"send-icon\"></image>\r\n\t\t\t\t</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport { \r\n\t\tsendAIMessage, \r\n\t\tsaveChatToBackend, \r\n\t\tgetSelectedChat, \r\n\t\tcopyMessage, \r\n\t\tsubmitFeedback,\r\n\t\tgetCurrentTime,\r\n\t\tgetCurrentDateTime,\r\n\t\tgenerateChatId,\r\n\t\tgetChatTitle\r\n\t} from './api.js';\r\n\t\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tmessageList: [], // 消息列表\r\n\t\t\t\tinputMessage: '', // 输入框内容\r\n\t\t\t\tisLoading: false, // 是否正在加载\r\n\t\t\t\tscrollTop: 0, // 滚动位置\r\n\t\t\t\tscrollIntoView: '', // 滚动到指定消息\r\n\t\t\t\tuserAvatar: '/static/logo.png', // 用户头像\r\n\t\t\t\taiAvatar: '/static/logo.png', // AI头像\r\n\t\t\t\tcurrentChatId: null, // 当前对话ID\r\n\t\t\t\thistoryChats: [], // 历史对话列表\r\n\t\t\t\tsearchKeyword: '', // 搜索关键词\r\n\t\t\t\tsearchResults: [], // 搜索结果\r\n\t\t\t\tquotedMessage: null, // 引用的消息\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\t// 页面加载时初始化新对话状态\r\n\t\t\tthis.messageList = [];\r\n\t\t\tthis.currentChatId = generateChatId();\r\n\t\t\tthis.inputMessage = '';\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\t// 检查是否有从历史页面传递过来的对话数据\r\n\t\t\tconst selectedChat = getSelectedChat();\r\n\t\t\tif (selectedChat) {\r\n\t\t\t\tconsole.log('检测到历史对话数据:', selectedChat);\r\n\t\t\t\tthis.loadChat(selectedChat);\r\n\t\t\t} else {\r\n\t\t\t\t// 如果没有选择历史对话，确保是新的对话状态\r\n\t\t\t\tif (this.messageList.length === 0) {\r\n\t\t\t\t\tthis.currentChatId = generateChatId();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tonHide() {\r\n\t\t\t// 页面隐藏时保存当前对话\r\n\t\t\tif (this.messageList.length > 0) {\r\n\t\t\t\tthis.saveCurrentChat();\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 显示历史侧边栏\r\n\t\t\tshowHistorySidebar() {\r\n\t\t\t\tconsole.log('showHistorySidebar 被调用');\r\n\t\t\t\t// 跳转到历史页面\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/chatAI/history'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 加载指定对话\r\n\t\t\tloadChat(chat) {\r\n\t\t\t\tconsole.log('加载历史对话:', chat);\r\n\t\t\t\tthis.currentChatId = chat.id;\r\n\t\t\t\tthis.messageList = [...chat.messages];\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t// 延迟滚动确保DOM完全渲染\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.scrollToBottom();\r\n\t\t\t\t\t}, 100);\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// 显示加载成功提示\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '对话加载成功',\r\n\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 显示历史对话列表\r\n\t\t\tshowHistory() {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '历史对话功能开发中',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\t// 这里可以跳转到历史对话页面或显示历史对话列表\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 创建新对话\r\n\t\t\tcreateNewChat() {\r\n\t\t\t\t// 如果当前有对话内容，询问是否保存\r\n\t\t\t\tif (this.messageList.length > 0) {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle: '创建新对话',\r\n\t\t\t\t\t\tcontent: '确定要开始新的对话吗？当前对话将被保存。',\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t// 保存当前对话到历史记录\r\n\t\t\t\t\t\t\t\tthis.saveCurrentChat();\r\n\t\t\t\t\t\t\t\tthis.resetToNewChat();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 如果当前没有对话内容，直接创建新对话\r\n\t\t\t\t\tthis.resetToNewChat();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 重置为新对话\r\n\t\t\tresetToNewChat() {\r\n\t\t\t\tthis.messageList = [];\r\n\t\t\t\t// 生成新的对话ID，避免重复\r\n\t\t\t\tthis.currentChatId = generateChatId();\r\n\t\t\t\tthis.inputMessage = '';\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '已创建新对话',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 保存当前对话\r\n\t\t\tasync saveCurrentChat() {\r\n\t\t\t\tif (this.messageList.length === 0) return;\r\n\t\t\t\t\r\n\t\t\t\t// 获取对话标题\r\n\t\t\t\tconst title = getChatTitle(this.messageList);\r\n\t\t\t\t\r\n\t\t\t\t// 确保有唯一的对话ID\r\n\t\t\t\tconst chatId = this.currentChatId || generateChatId();\r\n\t\t\t\t\r\n\t\t\t\tconst newChat = {\r\n\t\t\t\t\tid: chatId,\r\n\t\t\t\t\ttitle: title,\r\n\t\t\t\t\tlastTime: getCurrentDateTime(),\r\n\t\t\t\t\tmessages: [...this.messageList]\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t// 使用API保存对话到后端\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait saveChatToBackend(newChat);\r\n\t\t\t\t\tconsole.log('对话已保存到后端:', newChat);\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('保存对话失败:', error);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '保存失败，请检查网络',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t// 发送消息\r\n\t\t\tsendMessage() {\r\n\t\t\t\tif (!this.inputMessage.trim() || this.isLoading) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 如果有引用，将引用内容添加到消息中\r\n\t\t\t\tlet messageContent = this.inputMessage;\r\n\t\t\t\tlet hasQuote = false;\r\n\t\t\t\tif (this.quotedMessage) {\r\n\t\t\t\t\tmessageContent = `引用：${this.quotedMessage.content}\\n\\n${this.inputMessage}`;\r\n\t\t\t\t\thasQuote = true;\r\n\t\t\t\t\t// 清除引用\r\n\t\t\t\t\tthis.quotedMessage = null;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 添加用户消息\r\n\t\t\t\tthis.addMessage({\r\n\t\t\t\t\ttype: 'user',\r\n\t\t\t\t\tcontent: messageContent,\r\n\t\t\t\t\ttime: this.getCurrentTime(),\r\n\t\t\t\t\thasQuote: hasQuote\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tconst userQuestion = this.inputMessage;\r\n\t\t\t\tthis.inputMessage = '';\r\n\t\t\t\t\r\n\t\t\t\t// 显示加载状态\r\n\t\t\t\tthis.isLoading = true;\r\n\t\t\t\t\r\n\t\t\t\t// 模拟AI回复（实际项目中应该调用真实的API）\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.getAIResponse(userQuestion);\r\n\t\t\t\t}, 1000);\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 获取AI回复\r\n\t\t\tasync getAIResponse(question) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await sendAIMessage({\r\n\t\t\t\t\t\tcontent: question,\r\n\t\t\t\t\t\ttype: 'user',\r\n\t\t\t\t\t\ttime: getCurrentTime()\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (response.success) {\r\n\t\t\t\t\t\t// 添加AI回复\r\n\t\t\t\t\t\tthis.addMessage({\r\n\t\t\t\t\t\t\ttype: 'ai',\r\n\t\t\t\t\t\t\tcontent: response.data.content,\r\n\t\t\t\t\t\t\ttime: response.data.time\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: 'AI回复失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('AI回复错误:', error);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '网络连接失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.isLoading = false;\r\n\t\t\t\t\r\n\t\t\t\t// 保存对话到历史记录\r\n\t\t\t\tthis.saveCurrentChat();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 添加消息到列表\r\n\t\t\taddMessage(message) {\r\n\t\t\t\tthis.messageList.push(message);\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t// 延迟滚动确保新消息完全渲染\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.scrollToBottom();\r\n\t\t\t\t\t}, 100);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 滚动到底部\r\n\t\t\tscrollToBottom() {\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t// 使用scroll-into-view滚动到最后一个消息\r\n\t\t\t\t\tif (this.messageList.length > 0) {\r\n\t\t\t\t\t\tconst lastIndex = this.messageList.length - 1;\r\n\t\t\t\t\t\tthis.scrollIntoView = `msg-${lastIndex}`;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 如果没有消息，滚动到顶部\r\n\t\t\t\t\t\tthis.scrollTop = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 获取当前时间\r\n\t\t\tgetCurrentTime() {\r\n\t\t\t\treturn getCurrentTime();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 获取当前日期时间\r\n\t\t\tgetCurrentDateTime() {\r\n\t\t\t\treturn getCurrentDateTime();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 搜索输入处理\r\n\t\t\tonSearchInput() {\r\n\t\t\t\tif (this.searchKeyword.trim()) {\r\n\t\t\t\t\tthis.performSearch();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.clearSearch();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 执行搜索\r\n\t\t\tperformSearch() {\r\n\t\t\t\tif (!this.searchKeyword.trim()) {\r\n\t\t\t\t\tthis.clearSearch();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst keyword = this.searchKeyword.toLowerCase();\r\n\t\t\t\tthis.searchResults = [];\r\n\t\t\t\t\r\n\t\t\t\tthis.messageList.forEach((message, index) => {\r\n\t\t\t\t\tif (message.content && message.content.toLowerCase().includes(keyword)) {\r\n\t\t\t\t\t\tthis.searchResults.push(index);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tif (this.searchResults.length > 0) {\r\n\t\t\t\t\t// 滚动到第一个搜索结果\r\n\t\t\t\t\tthis.scrollToMessage(this.searchResults[0]);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: `找到 ${this.searchResults.length} 个结果`,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '未找到相关内容',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 清除搜索\r\n\t\t\tclearSearch() {\r\n\t\t\t\tthis.searchKeyword = '';\r\n\t\t\t\tthis.searchResults = [];\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 检查消息是否高亮\r\n\t\t\tisMessageHighlighted(message) {\r\n\t\t\t\tif (!this.searchKeyword.trim()) return false;\r\n\t\t\t\tconst index = this.messageList.indexOf(message);\r\n\t\t\t\treturn this.searchResults.includes(index);\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 高亮搜索文本（已移除，改用CSS样式实现）\r\n\t\t\thighlightSearchText(text) {\r\n\t\t\t\treturn text; // 直接返回原文本，使用CSS样式实现高亮\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 滚动到指定消息\r\n\t\t\tscrollToMessage(index) {\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.scrollIntoView = `msg-${index}`;\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 复制消息内容\r\n\t\t\tasync copyMessage(content) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait copyMessage(content);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '已复制到剪贴板',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '复制失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 引用消息\r\n\t\t\tquoteMessage(message) {\r\n\t\t\t\tthis.quotedMessage = message;\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '已引用消息',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 清除引用\r\n\t\t\tclearQuote() {\r\n\t\t\t\tthis.quotedMessage = null;\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 切换收藏状态\r\n\t\t\ttoggleStar(message, index) {\r\n\t\t\t\t// 使用Vue.set确保响应式更新\r\n\t\t\t\tthis.$set(message, 'starred', !message.starred);\r\n\t\t\t\t\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: message.starred ? '已收藏' : '已取消收藏',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t// 反馈消息\r\n\t\t\tasync feedbackMessage(message) {\r\n\t\t\t\tuni.showActionSheet({\r\n\t\t\t\t\titemList: ['有帮助', '无帮助', '内容错误', '其他问题'],\r\n\t\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\t\tconst feedbackTypes = ['有帮助', '无帮助', '内容错误', '其他问题'];\r\n\t\t\t\t\t\tconst selectedType = feedbackTypes[res.tapIndex];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tawait submitFeedback({\r\n\t\t\t\t\t\t\t\ttype: selectedType,\r\n\t\t\t\t\t\t\t\tmessage: message.content,\r\n\t\t\t\t\t\t\t\tchatId: this.currentChatId\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: `感谢您的反馈：${selectedType}`,\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t\tconsole.error('提交反馈失败:', error);\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '反馈提交失败',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 获取引用内容\r\n\t\t\tgetQuoteContent(content) {\r\n\t\t\t\tif (content.includes('引用：')) {\r\n\t\t\t\t\tconst parts = content.split('\\n\\n');\r\n\t\t\t\t\tif (parts.length > 1) {\r\n\t\t\t\t\t\tconst quoteText = parts[0].replace('引用：', '');\r\n\t\t\t\t\t\t// 只显示前30个字符，确保一行显示\r\n\t\t\t\t\t\treturn quoteText.length > 30 ? quoteText.substring(0, 30) + '...' : quoteText;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn '';\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// 获取主要内容\r\n\t\t\tgetMainContent(content) {\r\n\t\t\t\tif (content.includes('引用：')) {\r\n\t\t\t\t\tconst parts = content.split('\\n\\n');\r\n\t\t\t\t\tif (parts.length > 1) {\r\n\t\t\t\t\t\treturn parts.slice(1).join('\\n\\n');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn content;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.chat-container {\r\n\t\theight: 100vh;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tbackground: #f5f5f5;\r\n\t\tposition: relative;\r\n\t\twidth: 100%;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\t\r\n\t.search-container {\r\n\t\tbackground: rgba(255, 255, 255, 0.9);\r\n\t\tpadding: 20rpx 40rpx;\r\n\t\tborder-bottom: 1rpx solid rgba(76, 175, 80, 0.1);\r\n\t\tposition: relative;\r\n\t\tz-index: 1;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 20rpx;\r\n\t}\r\n\t\t.history-btn {\r\n\t\twidth: 70rpx;\r\n\t\theight: 70rpx;\r\n\t\tbackground: transparent;\r\n\t\tborder: none;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tcursor: pointer;\r\n\t\ttransition: all 0.3s ease;\r\n\t}\r\n\r\n\t\r\n\t.history-btn:active {\r\n\t\topacity: 0.7;\r\n\t\ttransform: scale(0.95);\r\n\t}\r\n\t\r\n\t.history-icon {\r\n\t\twidth: 50rpx;\r\n\t\theight: 50rpx;\r\n\t\tfilter: brightness(0) saturate(0) invert(0.3);\r\n\t}\r\n\t\r\n\t.search-box {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground: rgba(255, 255, 255, 0.8);\r\n\t\tborder-radius: 25rpx;\r\n\t\tpadding: 20rpx 25rpx;\r\n\t\tborder: 1rpx solid rgba(76, 175, 80, 0.2);\r\n\t\tposition: relative;\r\n\t\tflex: 1;\r\n\t}\r\n\t\r\n\t.search-icon {\r\n\t\twidth: 35rpx;\r\n\t\theight: 35rpx;\r\n\t\tmargin-right: 20rpx;\r\n\t}\r\n\t\r\n\t.search-input {\r\n\t\tflex: 1;\r\n\t\tfont-size: 28rpx;\r\n\t\tbackground: transparent;\r\n\t\tborder: none;\r\n\t\toutline: none;\r\n\t\tcolor: #000000;\r\n\t}\r\n\t\r\n\t.search-input::placeholder {\r\n\t\tcolor: #66BB6A;\r\n\t}\r\n\t\r\n\t.clear-btn {\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t\tbackground-color: #66BB6A;\r\n\t\tborder-radius: 50%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-left: 15rpx;\r\n\t}\r\n\t\r\n\t.clear-icon {\r\n\t\tcolor: white;\r\n\t\tfont-size: 24rpx;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t\r\n\t.chat-list {\r\n\t\tflex: 1;\r\n\t\tpadding: 30rpx 20rpx;\r\n\t\toverflow-y: auto;\r\n\t\twidth: 100%;\r\n\t\tbox-sizing: border-box;\r\n\t\tposition: relative;\r\n\t\tz-index: 1;\r\n\t}\r\n\t\r\n\t.welcome-container {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tmin-height: 60vh;\r\n\t\tpadding: 40rpx;\r\n\t}\r\n\t\r\n\t.welcome-content {\r\n\t\ttext-align: center;\r\n\t\tbackground: rgba(255, 255, 255, 0.95);\r\n\t\tborder-radius: 20rpx;\r\n\t\tpadding: 60rpx 40rpx;\r\n\t\tbox-shadow: 0 4rpx 20rpx rgba(76, 175, 80, 0.15);\r\n\t\tmax-width: 600rpx;\r\n\t\tborder: 1rpx solid rgba(76, 175, 80, 0.1);\r\n\t}\r\n\t\r\n\t.welcome-title {\r\n\t\tfont-size: 36rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #2E7D32;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tdisplay: block;\r\n\t}\r\n\t\r\n\t.welcome-subtitle {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #4CAF50;\r\n\t\tmargin-bottom: 40rpx;\r\n\t\tdisplay: block;\r\n\t}\r\n\t\r\n\t.welcome-features {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 20rpx;\r\n\t}\r\n\t\r\n\t.feature-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 20rpx;\r\n\t\tbackground: rgba(76, 175, 80, 0.1);\r\n\t\tborder-radius: 15rpx;\r\n\t\tborder: 1rpx solid rgba(76, 175, 80, 0.2);\r\n\t}\r\n\t\r\n\t.feature-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #2E7D32;\r\n\t}\r\n\t\r\n\t.message-item {\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\t\r\n\t.message-content {\r\n\t\tdisplay: flex;\r\n\t\talign-items: flex-start;\r\n\t}\r\n\t\r\n\t.user-message .message-content {\r\n\t\tflex-direction: row-reverse;\r\n\t}\r\n\t\r\n\t.avatar {\r\n\t\twidth: 60rpx;\r\n\t\theight: 60rpx;\r\n\t\tborder-radius: 50%;\r\n\t\toverflow: hidden;\r\n\t\tmargin: 0 10rpx;\r\n\t\tborder: 2rpx solid rgba(76, 175, 80, 0.2);\r\n\t}\r\n\t\r\n\t.avatar-img {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\t\r\n\t.message-bubble {\r\n\t\tmax-width: 75%;\r\n\t\tpadding: 25rpx 30rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\tposition: relative;\r\n\t\tword-wrap: break-word;\r\n\t\tword-break: break-word;\r\n\t}\r\n\t\r\n\t.user-message .message-bubble {\r\n\t\tbackground: linear-gradient(135deg, #cdecce 0%, #cdecce 0%);\r\n\t\tcolor: #333;\r\n\t\tborder-bottom-right-radius: 5rpx;\r\n\t\tbox-shadow: 0 4rpx 15rpx rgba(131, 212, 134, 0.2);\r\n\t}\r\n\t\r\n\t.user-message .quote-content {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: rgba(0, 0, 0, 0.7);\r\n\t\tline-height: 1.3;\r\n\t\tword-wrap: break-word;\r\n\t\tmargin-bottom: 8rpx;\r\n\t}\r\n\t\r\n\t.ai-message .message-bubble {\r\n\t\tbackground: rgba(255, 255, 255, 0.95);\r\n\t\tcolor: rgba(0, 0, 0, 0.7);\r\n\t\tborder-bottom-left-radius: 5rpx;\r\n\t\tbox-shadow: 0 4rpx 15rpx rgba(76, 175, 80, 0.15);\r\n\t\tborder: 1rpx solid rgba(76, 175, 80, 0.1);\r\n\t}\r\n\t\r\n\t.message-text {\r\n\t\tfont-size: 32rpx;\r\n\t\tline-height: 1.6;\r\n\t\tword-wrap: break-word;\r\n\t}\r\n\t\r\n\t.message-image {\r\n\t\tmax-width: 100%;\r\n\t\tmax-height: 400rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.message-time {\r\n\t\tfont-size: 26rpx;\r\n\t\topacity: 0.7;\r\n\t\tmargin-top: 10rpx;\r\n\t\tdisplay: block;\r\n\t}\r\n\t\r\n\t.loading-message {\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\t\r\n\t.typing-indicator {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 10rpx 0;\r\n\t}\r\n\t\r\n\t.dot {\r\n\t\twidth: 8rpx;\r\n\t\theight: 8rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground-color: #4CAF50;\r\n\t\tmargin: 0 4rpx;\r\n\t\tanimation: typing 1.4s infinite ease-in-out;\r\n\t}\r\n\t\r\n\t.dot:nth-child(1) {\r\n\t\tanimation-delay: -0.32s;\r\n\t}\r\n\t\r\n\t.dot:nth-child(2) {\r\n\t\tanimation-delay: -0.16s;\r\n\t}\r\n\t\r\n\t@keyframes typing {\r\n\t\t0%, 80%, 100% {\r\n\t\t\ttransform: scale(0.8);\r\n\t\t\topacity: 0.5;\r\n\t\t}\r\n\t\t40% {\r\n\t\t\ttransform: scale(1);\r\n\t\t\topacity: 1;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.quote-container {\r\n\t\tbackground: rgba(255, 255, 255, 0.95);\r\n\t\tpadding: 20rpx 40rpx;\r\n\t\tborder-top: 1rpx solid rgba(76, 175, 80, 0.1);\r\n\t\tposition: relative;\r\n\t\tz-index: 1;\r\n\t}\r\n\t\r\n\t.quote-content {\r\n\t\tdisplay: flex;\r\n\t\talign-items: flex-start;\r\n\t\tbackground: rgba(76, 175, 80, 0.1);\r\n\t\tborder-radius: 15rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tborder: 1rpx solid rgba(76, 175, 80, 0.2);\r\n\t\tposition: relative;\r\n\t}\r\n\t\r\n\t.quote-label {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: rgba(0, 0, 0, 0.7);\r\n\t\tfont-weight: bold;\r\n\t\tmargin-right: 15rpx;\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\t\r\n\t.quote-text {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: rgba(0, 0, 0, 0.7);\r\n\t\tline-height: 1.4;\r\n\t\tflex: 1;\r\n\t\tword-wrap: break-word;\r\n\t}\r\n\t\r\n\t.quote-close {\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t\tbackground: rgba(76, 175, 80, 0.2);\r\n\t\tborder-radius: 50%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-left: 15rpx;\r\n\t\tflex-shrink: 0;\r\n\t}\r\n\t\r\n\t.close-icon {\r\n\t\tcolor: #4CAF50;\r\n\t\tfont-size: 24rpx;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t\r\n\t.input-area {\r\n\t\tbackground: rgba(255, 255, 255, 0.95);\r\n\t\tpadding: 30rpx 40rpx;\r\n\t\tborder-top: 1rpx solid rgba(76, 175, 80, 0.1);\r\n\t\tposition: relative;\r\n\t\tz-index: 1;\r\n\t}\r\n\t\r\n\t.input-container {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\t\r\n\t.new-chat-btn {\r\n\t\twidth: 70rpx;\r\n\t\theight: 70rpx;\r\n\t\tbackground: linear-gradient(135deg, #4CAF50 0%, #66BB6A 100%);\r\n\t\tborder: none;\r\n\t\toutline: none;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 0;\r\n\t\tborder-radius: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 15rpx rgba(76, 175, 80, 0.3);\r\n\t\ttransition: all 0.3s ease;\r\n\t}\r\n\t\r\n\t.new-chat-btn:active {\r\n\t\ttransform: scale(0.95);\r\n\t\topacity: 0.8;\r\n\t}\r\n\t\r\n\t.new-chat-btn[disabled] {\r\n\t\topacity: 0.5;\r\n\t\tbackground: #ccc;\r\n\t\tbox-shadow: none;\r\n\t}\r\n\t\r\n\t.new-chat-btn:focus {\r\n\t\toutline: none;\r\n\t\tborder: none;\r\n\t}\r\n\t\r\n\t.new-chat-icon {\r\n\t\twidth: 50rpx;\r\n\t\theight: 50rpx;\r\n\t\tfilter: brightness(0) invert(1);\r\n\t}\r\n\t\r\n\t.message-input {\r\n\t\tflex: 1;\r\n\t\theight: 80rpx;\r\n\t\tpadding: 0 25rpx;\r\n\t\tborder: 1rpx solid rgba(76, 175, 80, 0.2);\r\n\t\tborder-radius: 40rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tbackground: rgba(255, 255, 255, 0.8);\r\n\t\tcolor: #000000;\r\n\t}\r\n\t\r\n\t.message-input::placeholder {\r\n\t\tcolor: #66BB6A;\r\n\t}\r\n\t\r\n\t.send-btn {\r\n\t\tmargin-left: 20rpx;\r\n\t\theight: 70rpx;\r\n\t\twidth: 70rpx;\r\n\t\tpadding: 0;\r\n\t\tbackground: linear-gradient(135deg, #4CAF50 0%, #66BB6A 100%);\r\n\t\tborder-radius: 40rpx;\r\n\t\tborder: none;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tbox-shadow: 0 4rpx 15rpx rgba(76, 175, 80, 0.3);\r\n\t}\r\n\t\r\n\t.send-btn[disabled] {\r\n\t\tbackground: #ccc;\r\n\t\tbox-shadow: none;\r\n\t}\r\n\t\r\n\t.send-icon {\r\n\t\twidth: 50rpx;\r\n\t\theight: 50rpx;\r\n\t\tfilter: brightness(0) invert(1);\r\n\t}\r\n\t\r\n\t.highlighted-message {\r\n\t\tbackground-color: rgba(255, 215, 0, 0.2);\r\n\t\tborder: 2rpx solid #ffd700;\r\n\t\tborder-radius: 10rpx;\r\n\t\tbox-shadow: 0 0 10rpx rgba(255, 215, 0, 0.3);\r\n\t}\r\n\t\r\n\t.highlighted-message .message-bubble {\r\n\t\tbackground-color: rgba(255, 215, 0, 0.1);\r\n\t}\r\n\t\r\n\t.message-actions {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-top: 15rpx;\r\n\t\tpadding-top: 15rpx;\r\n\t\tborder-top: 1rpx solid rgba(76, 175, 80, 0.1);\r\n\t}\r\n\t\r\n\t.action-btn {\r\n\t\twidth: 50rpx;\r\n\t\theight: 50rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-right: 20rpx;\r\n\t\ttransition: all 0.3s ease;\r\n\t}\r\n\t\r\n\t.action-btn:active {\r\n\t\ttransform: scale(0.9);\r\n\t\topacity: 0.7;\r\n\t}\r\n\t\r\n\t.action-icon {\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t\tfilter: brightness(0) saturate(0) invert(0.3);\r\n\t}\r\n\t\r\n\t.quote-content {\r\n\t\tfont-size: 28rpx;\r\n\t\tline-height: 1.3;\r\n\t\tword-wrap: break-word;\r\n\t}\r\n\t\r\n\t.quote-divider {\r\n\t\theight: 1rpx;\r\n\t\tbackground: rgba(0, 0, 0, 0.2);\r\n\t\tmargin: 8rpx 0;\r\n\t}\r\n</style>\r\n\r\n","import MiniProgramPage from 'D:/Projects/frontend/pages/chatAI/chatAI.vue'\nwx.createPage(MiniProgramPage)"],"names":["generateChatId","getSelectedChat","uni","getChatTitle","getCurrentDateTime","saveChatToBackend","sendAIMessage","getCurrentTime","copyMessage","submitFeedback"],"mappings":"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"}